{# Interest Profiles Tab Content #}
<section class="row g-4 mb-4">
    <!-- Interest Profiles List (Left Column) -->
    <div class="col-12 col-xl-4">
        <article class="card alert-profiles-list-card" aria-labelledby="interest-profiles-list-heading">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="card-title mb-0" id="interest-profiles-list-heading">Interest Profiles</h2>
                    <small class="text-muted"><span id="interest-profiles-count">0</span> profiles</small>
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-primary" type="button" id="btn-interest-bulk-actions" title="Bulk actions">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                        </svg>
                    </button>
                    <button class="btn btn-sm btn-primary" type="button" id="btn-new-interest-profile">
                        <svg width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
                        </svg>
                        New
                    </button>
                </div>
            </div>
            <div class="card-body p-0">
                <!-- Search/Filter Bar -->
                <div class="p-3 border-bottom">
                    <input type="text" class="form-control form-control-sm" id="interest-profiles-search" placeholder="ðŸ” Search profiles...">
                </div>
                <!-- Profiles List -->
                <div class="interest-profiles-list-container" id="interest-profiles-list-container">
                    <div class="list-group list-group-flush" id="interest-profiles-list">
                        <!-- Populated dynamically by interest_profiles.js -->
                    </div>
                </div>
            </div>
        </article>
    </div>

    <!-- Interest Profile Editor (Right Column) -->
    <div class="col-12 col-xl-8">
        <article class="card h-100" aria-labelledby="interest-profile-editor-heading">
            <div class="card-header">
                <div>
                    <h2 class="card-title mb-0" id="interest-profile-editor-heading">Interest Profile Editor</h2>
                    <small class="text-muted">Create and refine semantic interest profiles</small>
                </div>
            </div>
            <div class="card-body">
                {% include 'profiles/_interest_profile_form.html' %}
            </div>
        </article>
    </div>
</section>

{# Similarity Tester Component #}
<div class="row g-3 mt-0">
    <div class="col-12">
        <article class="card h-100" aria-labelledby="profile-tester-heading">
            <div class="card-header">
                <h3 class="card-title mb-0" id="profile-tester-heading">Similarity Tester</h3>
                <small class="text-muted">Test how similar messages are to your interest profile's training samples</small>
            </div>
            <div class="card-body">
                <form id="similarity-test-form" class="needs-validation" novalidate>
                    <div class="row g-3">
                        <!-- Profile Selection -->
                        <div class="col-12 col-md-4">
                            <label for="profile-select" class="form-label">
                                Select Profile
                                <span class="text-danger">*</span>
                            </label>
                            <select class="form-select" id="profile-select" required>
                                <option value="">Choose a profile...</option>
                                <!-- Populated dynamically by JS -->
                            </select>
                            <div class="invalid-feedback">
                                Please select an interest profile to test against.
                            </div>
                        </div>

                        <!-- Test Phrase Input -->
                        <div class="col-12 col-md-8">
                            <label for="test-phrase" class="form-label">
                                Test Message
                                <span class="text-danger">*</span>
                            </label>
                            <textarea 
                                class="form-control" 
                                id="test-phrase" 
                                rows="3" 
                                placeholder="Enter a message or phrase to test..."
                                required
                                maxlength="1000"></textarea>
                            <div class="form-text">
                                Enter any text to see how similar it is to the selected profile's training samples (max 1000 chars)
                            </div>
                            <div class="invalid-feedback">
                                Please enter a message to test.
                            </div>
                        </div>

                        <!-- Test Button -->
                        <div class="col-12">
                            <button 
                                type="button" 
                                class="btn btn-primary" 
                                id="btn-run-test">
                                <svg width="16" height="16" fill="currentColor" class="bi bi-lightning-charge" viewBox="0 0 16 16">
                                    <path d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"/>
                                </svg>
                                Test Similarity
                            </button>
                        </div>

                        <!-- Results Display -->
                        <div class="col-12">
                            <div class="alert alert-info d-none" id="similarity-result-container" role="alert">
                                <div class="d-flex align-items-center gap-3">
                                    <div>
                                        <h5 class="alert-heading mb-1">Similarity Score</h5>
                                        <p class="mb-0" id="test-result">
                                            <strong id="similarity-score-value">--</strong>
                                        </p>
                                    </div>
                                    <div class="ms-auto">
                                        <div class="progress similarity-progress-bar">
                                            <div 
                                                class="progress-bar" 
                                                id="similarity-score-bar" 
                                                role="progressbar" 
                                                aria-label="Similarity score percentage"
                                                aria-valuenow="0" 
                                                aria-valuemin="0" 
                                                aria-valuemax="100">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="small">
                                    <strong>Interpretation:</strong>
                                    <ul class="mb-0 mt-2">
                                        <li><strong>0.00 - 0.30:</strong> Very different from profile interests</li>
                                        <li><strong>0.30 - 0.50:</strong> Somewhat related</li>
                                        <li><strong>0.50 - 0.70:</strong> Moderately similar</li>
                                        <li><strong>0.70 - 0.85:</strong> Highly similar</li>
                                        <li><strong>0.85 - 1.00:</strong> Very closely matches profile</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Info Box -->
                        <div class="col-12">
                            <div class="alert alert-light border">
                                <h6 class="alert-heading">
                                    <svg width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                        <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                    </svg>
                                    How It Works
                                </h6>
                                <p class="small mb-0">
                                    This tool uses the <strong>all-MiniLM-L6-v2</strong> sentence transformer model loaded in the Sentinel service.
                                    It computes semantic similarity between your test message and the positive training samples in the selected profile.
                                    Scores range from 0.00 (completely different) to 1.00 (nearly identical meaning).
                                </p>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </article>
    </div>
</div>
